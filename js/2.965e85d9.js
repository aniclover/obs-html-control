(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"008a":function(e,t,s){},"0511":function(e,t,s){},"1cbd":function(e,t,s){"use strict";s("0511")},"34e4":function(e,t,s){"use strict";s("868d")},"34f8":function(e,t,s){"use strict";s("008a")},"4dcb":function(e,t,s){"use strict";s("8540")},"50e3":function(e,t,s){"use strict";s("fe37")},"713b":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-layout",{staticClass:"base",attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("div",{staticClass:"row justify-between full-width"},[s("div",{staticClass:"col-auto"},[s("q-toolbar-title",[e._v("\n            OBS Festival Control\n          ")])],1),s("div",{staticClass:"col-grow"},[s("MidiHub",{attrs:{obsIsConnected:e.obsIsConnected,scenes:e.scenes,sources:e.sources,updateFader:e.updateFader}})],1),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"row no-wrap justify-end"},[s("q-btn",{attrs:{loading:e.obsConnectionPending,color:e.obsBtnColor,label:e.obsBtnLabel},on:{click:function(t){return e.onConnectBtn()}}}),s("q-input",{attrs:{outlined:"","bg-color":"white",label:e.obsAddressLabel,"stack-label":"",dense:!0},model:{value:e.obsAddress,callback:function(t){e.obsAddress=t},expression:"obsAddress"}})],1)])])]),s("div",{staticClass:"row flex-nowrap",staticStyle:{"background-color":"black"}},[s("FaderPanel",{ref:"faderPanel",attrs:{obs:e.obs,sources:e.sources,obsIsConnected:e.obsIsConnected}})],1),s("div",{staticClass:"row"},[s("q-btn",{staticClass:"col-auto mini",attrs:{color:"grey",stack:"",icon:"navigate_before",label:"Timetable"},on:{click:function(t){return e.timetable("retract")}}}),s("q-btn",{staticClass:"col-auto mini",attrs:{color:"grey",stack:"",icon:"linked_camera",label:"Active"},on:{click:function(t){return e.screenshot("active")}}}),s("q-btn",{staticClass:"col",attrs:{color:"red",label:"Transition"},on:{click:function(t){return e.transition()}}}),s("q-btn",{staticClass:"col-auto mini",attrs:{color:"grey",stack:"",icon:"navigate_before",label:"Timetable"},on:{click:function(t){return e.timetable("retract")}}}),s("q-btn",{staticClass:"col-auto mini",attrs:{color:"grey",stack:"",icon:"navigate_next",label:"Timetable"},on:{click:function(t){return e.timetable("advance")}}}),s("q-btn",{staticClass:"col",attrs:{color:"red",label:"Transition"},on:{click:function(t){return e.transition()}}}),s("q-btn",{staticClass:"col-auto mini",attrs:{color:"grey",stack:"",icon:"linked_camera",label:"Active"},on:{click:function(t){return e.screenshot("active")}}}),s("q-btn",{staticClass:"col-auto mini",attrs:{color:"grey",stack:"",icon:"navigate_next",label:"Timetable"},on:{click:function(t){return e.timetable("advance")}}})],1)],1),s("q-page-container",[s("q-page",[s("div",{staticClass:"q-pa-sm"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col panel"},[s("ScenePanel",{attrs:{obs:e.obs,scenes:e.scenes,status:e.status}})],1),s("div",{staticClass:"col panel"},[s("SourcePanel",{attrs:{obs:e.obs,sources:e.sources}})],1)])])])],1)],1)},n=[],o=(s("e01a"),s("fb6a"),s("4e82"),s("ddb0"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-pa-sm"},[s("div",{staticClass:"row"},e._l(e.scenes,(function(t,i){return s("SceneButton",{key:t.name,attrs:{obs:e.obs,scene:t,index:i,status:e.status,isPreview:i==e.status.previewIndex,isCurrent:i==e.status.currentIndex}})})),1)])}),a=[],c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"quarter"},[s("q-btn",{staticClass:"full-width",attrs:{color:e.color,"text-color":"black",label:e.scene.name},on:{click:function(t){return e.switchToScene()}}})],1)},r=[],l={name:"SceneButton",props:{obs:Object,scene:Object,index:Number,isPreview:Boolean,isCurrent:Boolean},created:function(){this.$root.$on("scene"+this.index,this.switchToScene)},destroyed:function(){this.$root.$off("scene"+this.index)},computed:{color:function(){let e="white";return this.isCurrent?e="red":this.isPreview&&(e="yellow"),console.log(`scene${this.index} color changed to ${e}`),this.$root.$emit("midiout",{name:"scene",index:this.index,color:e}),e}},methods:{switchToScene(){console.log(`switchToScene("${this.scene.name}")`),this.obs.send("SetPreviewScene",{"scene-name":this.scene.name})}}},d=l,u=(s("50e3"),s("710d")),h=s("9c40"),m=s("984b"),b=s.n(m),p=Object(u["a"])(d,c,r,!1,null,"2adca226",null),f=p.exports;b()(p,"components",{QBtn:h["a"]});var g={name:"ScenePanel",props:{obs:Object,scenes:Array,status:Object},components:{SceneButton:f},methods:{}},v=g,S=Object(u["a"])(v,o,a,!1,null,null,null),I=S.exports,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-pa-sm"},[s("div",{staticClass:"row"},e._l(e.sources,(function(t,i){return s("SourceButton",{key:t.name,attrs:{obs:e.obs,source:t,index:i}})})),1)])},O=[],x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"quarter"},[s("q-btn",{staticClass:"full-width",attrs:{stack:"",color:e.color,"text-color":"black"},on:{click:function(t){return e.onClick()}}},[s("q-icon",{attrs:{name:e.icon}}),s("div",{staticClass:"label"},[e._v("\n      "+e._s(e.source.name)+"\n    ")])],1)],1)},w=[],y=(s("e6cf"),{name:"SourceButton",props:{obs:Object,source:Object,index:Number},data(){return{settings:{},mediaState:"unknown"}},created:function(){this.loadSourceSettings(this.source),this.loadMediaState(),this.$root.$on("source"+this.index,this.onClick)},destroyed:function(){this.$root.$off("source"+this.index)},computed:{color:function(){let e="white";return"playing"===this.mediaState?e=this.settings.is_local_file?"green":"red":"paused"===this.mediaState&&(e="yellow"),this.$root.$emit("midiout",{name:"source",index:this.index,color:e}),e},icon:function(){return this.settings.is_local_file?"playing"===this.mediaState?"pause":"play_arrow":"autorenew"}},watch:{source:{deep:!0,handler(){this.source.needsUpdate=!1,this.loadMediaState()}}},methods:{onClick(){this.settings.is_local_file?"playing"===this.mediaState?this.obs.send("PlayPauseMedia",{sourceName:this.source.name,playPause:!0}):"paused"===this.mediaState?this.obs.send("PlayPauseMedia",{sourceName:this.source.name,playPause:!1}):this.obs.send("RestartMedia",{sourceName:this.source.name}):this.reloadSource()},reloadSource(){(async()=>{var e=await this.obs.send("GetSourceSettings",{sourceName:this.source.name});this.settings=e.sourceSettings,await this.obs.send("SetSourceSettings",{sourceName:this.source.name,sourceSettings:e.sourceSettings}),setTimeout(this.loadMediaState,50)})()},loadSourceSettings(e){(async()=>{var e=await this.obs.send("GetSourceSettings",{sourceName:this.source.name});this.settings=e.sourceSettings})()},loadMediaState(){(async()=>{var e=await this.obs.send("GetMediaState",{sourceName:this.source.name});this.mediaState=e.mediaState,console.log(`Media state is ${this.mediaState} for source ${this.source.name}`)})()}}}),$=y,B=(s("34e4"),s("0016")),T=Object(u["a"])($,x,w,!1,null,"84ab58a6",null),k=T.exports;b()(T,"components",{QBtn:h["a"],QIcon:B["a"]});var M={name:"SourcePanel",props:{obs:Object,sources:Array},components:{SourceButton:k},methods:{transition(){}}},N=M,q=Object(u["a"])(N,C,O,!1,null,null,null),P=q.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-pa-sm full-width"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("q-btn",{attrs:{icon:"insights",size:"s",color:"red",padding:"none"},on:{click:e.autoUpdateFaders}})],1),e._l(4,(function(t,i){return s("Fader",{key:i,ref:"faders",refInFor:!0,attrs:{index:i,obs:e.obs,sources:e.sources}})}))],2)])},J=[],_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col fader"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto fader"},[s("q-select",{attrs:{options:e.sources,"option-label":"name","option-value":"name","bg-color":e.labelBgColor,"map-options":"","emit-value":"",dark:"",dense:"",borderless:"","hide-bottom-space":""},on:{input:e.sourceChanged},model:{value:e.selectedSource,callback:function(t){e.selectedSource=t},expression:"selectedSource"}})],1),s("div",{staticClass:"col fader"},[s("q-slider",{staticClass:"overlay-group",attrs:{color:"red",min:0,max:127,"label-value":e.sevenbitToDB(e.value).toFixed(1),"label-always":"",dark:""},on:{change:e.faderUIChanged},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),s("q-slider",{staticClass:"overlay overlay-group",attrs:{color:"grey-9",min:0,max:127,dark:"",readonly:""},model:{value:e.midiValue,callback:function(t){e.midiValue=t},expression:"midiValue"}})],1)])])},A=[],E={name:"Fader",props:{obs:Object,sources:Array,index:Number},data(){return{value:0,midiValue:0,isMidiLocked:!1,selectedSource:"",obsUpdateInProgress:!1,localUpdateInProgress:!1,localUpdateTimeout:null,labelBgColor:"none"}},created:function(){this.$root.$on("midiFader"+this.index,this.onMidiEvent)},destroyed:function(){this.$root.$off("midiFader"+this.index)},watch:{value:function(e,t){e===t||this.obsUpdateInProgress?this.obsUpdateInProgress=!1:this.sendValueToObs(e)}},computed:{color:function(){return"white"}},methods:{sevenbitToDB(e){let t=(e-127)/2.11666;return 0===e&&(t=-100),t},dbToMul(e){return Math.pow(10,e/20)},mulToDB(e){return 20*Math.log10(e)},dbToSevenbit(e){return e<-60&&(e=-60),Math.round(2.11666*e)+127},sendValueToObs(e){if(!this.selectedSource||0===this.selectedSource.length||""===this.selectedSource)return;const t=this.sevenbitToDB(e);null!==this.localUpdateTimeout&&clearTimeout(this.localUpdateTimeout),this.localUpdateInProgress=!0,this.localUpdateTimeout=setTimeout((()=>{this.localUpdateInProgress=!1}),300),this.obs.send("SetVolume",{source:this.selectedSource,volume:this.dbToMul(t),useDecibel:!1})},faderUIChanged(){this.isMidiLocked=!1},onMidiEvent(e){this.midiValue=e.value,this.isMidiLocked?this.value=this.midiValue:Math.abs(this.midiValue-this.value)<2&&(console.log("MIDI locked on"),this.isMidiLocked=!0,this.value=this.midiValue)},obsVolumeChanged(e){if(e.sourceName===this.selectedSource){if(this.localUpdateInProgress)return;const t=e.volume,s=this.mulToDB(t),i=this.dbToSevenbit(s);i!==this.value&&(this.obsUpdateInProgress=!0,this.value=i,this.isMidiLocked=!1,console.log(`OBS volume for ${this.selectedSource} changed to ${t}, ${s}, ${i}`))}},sourceChanged(){""!==this.selectedSource&&(this.isMidiLocked=!1,this.labelBgColor="none",(async()=>{var e=await this.obs.send("GetVolume",{source:this.selectedSource,useDecibel:!1});this.obsVolumeChanged({sourceName:e.name,volume:e.volume})})())}}},L=E,F=(s("1cbd"),s("ddd8")),j=s("c1d0"),U=s("8572"),V=Object(u["a"])(L,_,A,!1,null,"68dec5f4",null),Q=V.exports;b()(V,"components",{QSelect:F["a"],QSlider:j["a"],QField:U["a"]});var H={name:"FaderPanel",components:{Fader:Q},props:{obs:Object,sources:Array,obsIsConnected:Boolean},data(){return{}},created:function(){},computed:{color:function(){return"white"}},methods:{autoUpdateFaders(){let e=-1,t=-1;for(let s=0;s<2;s++)this.$refs.faders.forEach(((s,i)=>{0===s.value?t>-1&&t<this.sources.length&&(s.selectedSource=this.sources[t].name,s.sourceChanged(),t++):(e=this.sources.findIndex((e=>e.name===s.selectedSource)),e>-1&&(t=e+1,i>0&&(s.labelBgColor="red")))}))},obsVolumeChanged(e){this.$refs.faders.forEach((t=>{t.obsVolumeChanged(e)}))},updateFaderValue(e,t){e<0||e>=this.$refs.faders.length||this.$refs.faders[e].onMidiEvent({value:t})}}},G=H,W=(s("4dcb"),Object(u["a"])(G,D,J,!1,null,"3d0c1912",null)),R=W.exports;b()(W,"components",{QBtn:h["a"]});var z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row justify-center no-wrap"},[s("div",{staticClass:"col-2"},[s("q-select",{attrs:{options:e.midiInputsAvailable,disable:e.midiSelectDisabled,label:"MIDI Inputs","label-color":"orange",dense:"","hide-bottom-space":"",dark:""},on:{filter:e.initMidi},model:{value:e.midiInputName,callback:function(t){e.midiInputName=t},expression:"midiInputName"}})],1),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"edit",size:"m",color:"orange",padding:"none",disable:e.midiSelectDisabled},on:{click:function(t){e.showJsInputTextDialog=!0}}})],1),s("div",{staticClass:"col-2"},[s("q-select",{attrs:{options:e.midiOutputsAvailable,disable:e.midiSelectDisabled,label:"MIDI Outputs","label-color":"cyan",dense:"","hide-bottom-space":"",dark:""},on:{filter:e.initMidi},model:{value:e.midiOutputName,callback:function(t){e.midiOutputName=t},expression:"midiOutputName"}})],1),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{icon:"edit",size:"m",color:"cyan",padding:"none",disable:e.midiSelectDisabled},on:{click:function(t){e.showJsOutputTextDialog=!0}}})],1),s("div",{staticClass:"col-auto"},[s("q-btn",{attrs:{color:e.midiBtnColor,label:e.midiBtnLabel},on:{click:e.onMidiBtn}})],1),s("q-dialog",{attrs:{"full-width":"","full-height":""},on:{"before-hide":e.parseMidiJsHandler},model:{value:e.showJsInputTextDialog,callback:function(t){e.showJsInputTextDialog=t},expression:"showJsInputTextDialog"}},[s("q-card",[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("MIDI Input Dispatcher")])]),s("q-card-section",{staticClass:"q-pt-none editor-height"},[s("jsEditor",{attrs:{lang:"javascript",theme:"chrome",width:"100%"},on:{init:e.editorInit},model:{value:e.midiInputJsText,callback:function(t){e.midiInputJsText=t},expression:"midiInputJsText"}})],1),s("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK"}})],1)],1)],1),s("q-dialog",{attrs:{"full-width":"","full-height":""},on:{"before-hide":e.parseMidiJsHandler},model:{value:e.showJsOutputTextDialog,callback:function(t){e.showJsOutputTextDialog=t},expression:"showJsOutputTextDialog"}},[s("q-card",[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("MIDI Output Dispatcher")])]),s("q-card-section",{staticClass:"q-pt-none editor-height"},[s("jsEditor",{attrs:{lang:"javascript",theme:"chrome",width:"100%"},on:{init:e.editorInit},model:{value:e.midiOutputJsText,callback:function(t){e.midiOutputJsText=t},expression:"midiOutputJsText"}})],1),s("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK"}})],1)],1)],1)],1)},K=[],X={name:"MidiInputHub",components:{jsEditor:s("7c9e")},props:{obsIsConnected:Boolean,updateFader:Function},data(){return{midi:null,midiIsConnected:!1,midiBtnLabel:"Attach MIDI",midiInputsAvailable:null,midiInputName:"",showJsInputTextDialog:!1,midiInputJsText:null,midiInputJsHandler:null,midiOutputsAvailable:null,midiOutputName:"",showJsOutputTextDialog:!1,midiOutputJsText:null,midiOutputJsHandler:null,midiOutput:null}},created:function(){this.$root.$on("midiout",this.onMidiOutEvent),this.midi=s("c62b"),this.midiInputJsText=this.$q.localStorage.getItem("midiInputJsText"),this.midiInputJsText||(this.midiInputJsText="\n// Input: midiData\n// Output: [ eventName, eventData ]\n\nconsole.log(midiData);\n\nreturn [null, null];\n"),this.midiOutputJsText=this.$q.localStorage.getItem("midiOutputJsText"),this.midiOutputJsText||(this.midiOutputJsText="\n// Input: eventData, midiOutput\n// Output: none\n\nconsole.log(eventData);\n\n"),this.parseMidiJsHandler()},destroyed:function(){this.$root.$off("midiout"),this.midiInput.removeListener(),this.midi.disable()},computed:{midiBtnColor:function(){return this.midiIsConnected?"green":"grey"},midiSelectDisabled:function(){return!!this.midiIsConnected}},methods:{editorInit(){s("2099"),s("bb36"),s("95b8")},parseMidiJsHandler(){this.$q.localStorage.set("midiInputJsText",this.midiInputJsText),this.midiInputJsHandler=new Function("midiData",this.midiInputJsText),this.$q.localStorage.set("midiOutputJsText",this.midiOutputJsText),this.midiOutputJsHandler=new Function("eventData","midiOutput",this.midiOutputJsText)},onMidiBtn(){if(this.midiIsConnected)this.disconnectMidi(),this.midiIsConnected=!1,this.midiBtnLabel="Attach MIDI";else{const e=this.connectMidi();e&&(this.midiIsConnected=!0,this.midiBtnLabel="Detach MIDI")}},onMidiOutEvent(e){null!=this.midiOutput&&this.midiOutputJsHandler(e,this.midiOutput)},initMidi(e,t,s){this.midi.disable(),this.midiInputsAvailable=[],this.midiOutputsAvailable=[],this.midi.enable((e=>{e&&console.log("Webmidi Error:"+e),this.midi.inputs.map((e=>{this.midiInputsAvailable.push(e.name),console.log(`'${e.id} / '${e.name}`)})),this.midi.outputs.map((e=>{this.midiOutputsAvailable.push(e.name),console.log(`'${e.id} / '${e.name}`)})),"undefined"!==typeof t&&t()}))},disconnectMidi(){this.midiInput.removeListener(),this.midi.disable(),this.midiInputName="",this.midiInputsAvailable=[],this.midiOutputName="",this.midiOutputsAvailable=[],this.midiOutput=null},connectMidi(){return!(!this.midiInputName||""===this.midiInputName)&&(this.midiInput=this.midi.getInputByName(this.midiInputName),console.log(this.midiInput),this.midiInput?(this.midiInput.addListener("noteon","all",(e=>{const t=e.channel,s=e.note.number,i=e.velocity;this.obsIsConnected||console.log(`Channel: ${t} / Note: ${s} / Velocity: ${i}`);const[n,o]=this.midiInputJsHandler({channel:t,note:s});n&&this.$root.$emit(n,o)})),this.midiInput.addListener("controlchange","all",(e=>{const t=e.channel,s=e.controller.number,i=e.value;this.obsIsConnected||console.log(`Channel: ${t} / Control: ${s} / Value: ${i}`);const[n,o]=this.midiInputJsHandler({channel:t,control:s,value:i});n&&(n.startsWith("midiFader")?this.updateFader(o.index,o.value):this.$root.$emit(n,o))})),console.log(this.midiOutputName),this.midiOutputName&&(this.midiOutput=this.midi.getOutputByName(this.midiOutputName),console.log(this.midiOutput),!this.midiOutput)?(console.log(`MIDI Output named ${this.midiOutputName} could not be opened`),!0):(this.$root.$emit("midiout",{name:"init"}),!0)):(console.log(`MIDI Input named '${this.midiInputName}' could not be opened`),this.onMidiBtn(),!1))}}},Y=X,Z=(s("34f8"),s("24e8")),ee=s("f09f"),te=s("a370"),se=s("4b7e"),ie=s("7f67"),ne=Object(u["a"])(Y,z,K,!1,null,"4c724f94",null),oe=ne.exports;b()(ne,"components",{QSelect:F["a"],QBtn:h["a"],QDialog:Z["a"],QCard:ee["a"],QCardSection:te["a"],QCardActions:se["a"]}),b()(ne,"directives",{ClosePopup:ie["a"]});var ae=null,ce={name:"MainLayout",components:{ScenePanel:I,SourcePanel:P,FaderPanel:R,MidiHub:oe},data(){return{obsAddress:"",obsConnectionPending:!1,obsIsConnected:!1,obsBtnLabel:"Connect",obsAddressLabel:"OBS Address",obsStreamingStatus:null,obs:{},scenes:[],sources:[],srcMap:null,status:{previewIndex:-1,currentIndex:-1}}},computed:{obsBtnColor:function(){return this.obsIsConnected?"green":"grey"}},created:function(){"undefined"===typeof window.OBSWebSocket&&(window.OBSWebSocket=s("c223")),this.$root.$on("transition",this.transition),this.$root.$on("timetable",this.timetable),this.$root.$on("screenshot",this.screenshot)},destroyed:function(){try{this.disconnectOBS()}catch(e){}this.$root.$off("transition"),this.$root.$off("timetable"),this.$root.$off("screenshot")},methods:{updateFader(e,t){this.$refs.faderPanel.updateFaderValue(e,t)},onConnectBtn(){if(!this.obsConnectionPending)if(this.obsConnectionPending=!0,this.obsIsConnected)this.disconnectOBS();else try{this.connectOBS()}catch(e){console.log(e),this.obsConnectionPending=!1}},connectOBS(){this.initOBS();let e=!1,t=this.obsAddress;this.obsAddress.startsWith("wss://")?(e=!0,t=this.obsAddress.slice(6)):this.obsAddress.startsWith("ws://")&&(e=!1,t=this.obsAddress.slice(5)),this.obs.connect({address:t,secure:e}).catch((e=>{this.onOBSError(e)})),clearInterval(ae),ae=setInterval(this.obsInterval,1e3)},obsInterval(){this.obs.send("GetStreamingStatus").then((e=>{this.obsStreamingStatus=e}))},disconnectOBS(){clearInterval(ae),this.obs.disconnect(),this.obsConnectionPending=!1},onOBSConnected(){this.obsBtnLabel="Disconnect",this.obsConnectionPending=!1,this.obsIsConnected=!0,this.obs.send("GetSceneList").then((e=>{console.log("GetSceneList retrieved # scenes: "+String(e.scenes.length)),this.scenes=e.scenes,this.status.currentIndex=this.findSceneIndex(e.currentScene),this.obs.send("GetPreviewScene").then((e=>{this.status.previewIndex=this.findSceneIndex(e.name)})),this.obs.send("GetSourcesList").then((e=>{var t=new Map;e.sources.sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)),e.sources.forEach(((e,s)=>{"ffmpeg_source"===e.typeId&&(e.needsUpdate=!1,t.set(e.name,e))})),e.sources=Array.from(t.values()),this.sources=e.sources,this.srcMap=t}))}))},onOBSDisconnected(){this.obsBtnLabel="Connect",this.obsConnectionPending=!1,this.obsIsConnected=!1,this.scenes=[],this.sources=[],this.status.previewIndex=-1,this.status.currentIndex=-1},onOBSError(e){"CONNECTION_ERROR"===e.code&&(this.disconnectOBS(),this.onOBSDisconnected(),this.obsAddressLabel=e.description),this.obsConnectionPending=!1,console.error("OBS Websocket Error: ",e)},findSceneIndex(e){console.log(`findScene("${e}")`);for(var t=0;t<this.scenes.length;t++)if(this.scenes[t].name===e)return t;return-1},screenshot(e){this.obsIsConnected&&("undefined"===typeof e||"active"===e?(this.obs.send("TriggerHotkeyByName",{hotkeyName:"OBSBasic.Screenshot"}),console.log("Screenshot Active")):this.status.previewIndex>=0&&(this.obs.send("TriggerHotkeyByName",{hotkeyName:"OBSBasic.SelectedSourceScreenshot"}),console.log("Screenshot Preview")))},transition(){this.obsIsConnected&&this.obs.send("TransitionToProgram")},timetable(e){this.obsIsConnected&&("retract"===e?this.obs.send("TriggerHotkeyByName",{hotkeyName:"ROTATE_ccw"}):this.obs.send("TriggerHotkeyByName",{hotkeyName:"ROTATE_cw"}))},initOBS(){try{this.obs.disconnect()}catch(e){}this.obs=new window.OBSWebSocket,this.obs.on("error",(e=>{this.onOBSError(e)})),this.obs.on("ConnectionOpened",this.onOBSConnected),this.obs.on("ConnectionClosed",this.onOBSDisconnected),this.obs.on("SwitchScenes",(e=>{this.status.currentIndex=this.findSceneIndex(e.sceneName)})),this.obs.on("PreviewSceneChanged",(e=>{this.status.previewIndex=this.findSceneIndex(e.sceneName)})),this.obs.on("MediaPlaying",(e=>{this.notifySourceUpdate(e.sourceName)})),this.obs.on("MediaEnded",(e=>{this.notifySourceUpdate(e.sourceName)})),this.obs.on("MediaPaused",(e=>{this.notifySourceUpdate(e.sourceName)})),this.obs.on("MediaRestarted",(e=>{this.notifySourceUpdate(e.sourceName)})),this.obs.on("SourceVolumeChanged",(e=>{this.$refs.faderPanel.obsVolumeChanged(e)}))},notifySourceUpdate(e){console.log("notifySourceUpdate to "+e),this.srcMap.get(e).needsUpdate=!0}}},re=ce,le=(s("8d7a"),s("4d5a")),de=s("e359"),ue=s("65c6"),he=s("6ac5"),me=s("27f9"),be=s("09e3"),pe=s("9989"),fe=Object(u["a"])(re,i,n,!1,null,"6fbb23b0",null);t["default"]=fe.exports;b()(fe,"components",{QLayout:le["a"],QHeader:de["a"],QToolbar:ue["a"],QToolbarTitle:he["a"],QBtn:h["a"],QInput:me["a"],QPageContainer:be["a"],QPage:pe["a"]})},8540:function(e,t,s){},"868d":function(e,t,s){},"8d7a":function(e,t,s){"use strict";s("cec7")},cec7:function(e,t,s){},fe37:function(e,t,s){}}]);